index = round(sentence_num / n(), 1)) %>%
unnest_tokens(word, sentence) %>%
inner_join(get_sentiments("afinn")) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(score, na.rm = TRUE)) %>%
arrange(desc(sentiment))
ggplot(book_sent, aes(index, chapter, fill = sentiment)) +
geom_tile(colour = "white") +
scale_fill_gradient(low = "red", high = "steelblue") +
scale_x_continuous(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter", y = NULL) +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, chapter, fill = sentiment)) +
geom_tile() +
scale_fill_gradient(low = "red", high = "steelblue") +
scale_x_continuous(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, chapter, fill = sentiment)) +
geom_tile() +
scale_fill_gradient(low = "#ef8a62", high = "#67a9cf") +
scale_x_continuous(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "#ef8a62", high = "#67a9cf") +
scale_x_continuous(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "#ef8a62", high = "#67a9cf") +
scale_x_continuous(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "#ef8a62", high = "#67a9cf") +
scale_x_continuous(, labels = scale::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "#ef8a62", high = "#67a9cf") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent
book_sent %>% mutate(index = round(index, 1))
book_sent %>% mutate(index = round(index, 1), sentiment = sum(sentiment))
book_sent %>%
mutate(index = round(index, 1),
sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "#ef8a62", high = "#67a9cf") +
scale_x_continuous(, labels = scale::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1),
sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "#ef8a62", high = "#67a9cf") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1),
sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "red", high = "steelblue") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1),
sentiment = sum(sentiment))
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "red", high = "steelblue") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "red", high = "steelblue") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "#ef8a62", high = "#67a9cf") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "steelblue") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "steelblue") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "red", high = "green") +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
?scale_fill_gradient
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
#mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
#mutate(index = round(index, 1)) %>%
#group_by(chapter, index) %>%
#summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
?scale_fill_gradient
book_sent %>%
#mutate(index = round(index, 1)) %>%
#group_by(chapter, index) %>%
#summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient2() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, chapter, fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient2() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
book_sent %>%
mutate(index = round(index, 1)) %>%
group_by(chapter, index) %>%
summarise(sentiment = sum(sentiment)) %>%
ggplot(aes(index, rev(chapter), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, rev(chapter), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, reorder(chapter, rev(chapter)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, reorder(chapter, forcats::fact_rev(chapter)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, reorder(chapter, forcats::fct_rev(chapter)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, reorder(chapter, forcats::fct_rev(as.character(chapter))), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, reorder(chapter, as.character(chapter)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, reorder(chapter, as.factor(chapter)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, reorder(chapter, as.factor(chapter, levels = rev(chapter))), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, reorder(chapter, as.factor(chapter, levels = rev(chapter)))), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
rev(book_sent$chapter)
rev(unique(book_sent$chapter))
forcats::lvls_reorder(chapter)
forcats::lvls_reorder(book_sent$chapter)
factor(chapter)
factor(book_sent$chapter)
ggplot(book_sent, aes(index, factor(book_sent$chapter), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, factor(book_sent$chapter), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, factor(chapter, levels = rev(chapter)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, factor(chapter, levels = rev(unique(chapter))), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
order(unique(book_sent$chapter))
sort(unique(book_sent$chapter))
ggplot(book_sent, aes(index, factor(chapter, levels = sort(unique(chapter))), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, factor(chapter, levels = sort(unique(chapter))), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient2() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
?sort
ggplot(book_sent, aes(index, factor(chapter, levels = sort(unique(chapter), decreasing = TRUE)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient2() +
scale_x_continuous(, labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(book_sent, aes(index, factor(chapter, levels = sort(unique(chapter), decreasing = TRUE)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient2() +
scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
?scale_gill_gradient2
?scale_fill_gradient2
ggplot(book_sent, aes(index, factor(chapter, levels = sort(unique(chapter), decreasing = TRUE)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient2() +
scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
#legend.position = "none")
)
ggplot(book_sent, aes(index, factor(chapter, levels = sort(unique(chapter), decreasing = TRUE)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient2() +
scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
?labs
?philosophers_stone
ggplot(book_sent, aes(index, factor(chapter, levels = sort(unique(chapter), decreasing = TRUE)), fill = sentiment)) +
geom_tile(color = "white") +
scale_fill_gradient2() +
scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(x = "Chapter Progression", y = "Chapter") +
ggtitle("Sentiment of Harry Potter and the Philosopher's Stone",
subtitle = "Summary of the net sentiment score as you progress through each chapter") +
theme_minimal() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
?theme
library(ggplot2)
?scale_fill_gradient
scale_color_gradient()
?scale_color_gradient()
